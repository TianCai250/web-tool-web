import{d as b,r as L,a as I,t as y,b as R,e as i,f as g,w as u,u as o,i as k,y as C,h as S,l as U,E as j,m as p,o as m,n as B,j as E,p as H,q as N,_ as V}from"./index-9fca570e.js";class D{constructor(s,t={}){this.imgSrc=s,this.target=t.target||null,this.width=t.width||null,this.height=t.height||null,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.image=new Image,this.image.src=this.imgSrc,this.target&&(this.target.innerHTML="",this.target.append(this.canvas))}blackWhite(){return new Promise(s=>{console.log(this.image),this.image.onload=()=>{this.canvas.width=this.width||this.image.width,this.canvas.height=this.height||this.image.height,this.context.drawImage(this.image,0,0,this.canvas.width,this.canvas.height);let t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),d=t.data.length;for(let e=0;e<d;e+=4){let h=t.data[e],n=t.data[e+1],r=t.data[e+2],a=h*.299+n*.587+r*.114>=128?255:0;t.data[e]=a,t.data[e+1]=a,t.data[e+2]=a}this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(t,0,0),this.canvas.toBlob(e=>{s(URL.createObjectURL(e))})}})}}const f=c=>(H("data-v-7a07107c"),c=c(),N(),c),F={class:"image-gray"},M=f(()=>i("div",{class:"el-upload__text"},"拖拽或点击上传图片",-1)),O={class:"parse-btn"},T={class:"parse-result"},W=f(()=>i("div",{class:"label"},"转换结果",-1)),q={class:"result"},G=["src"],P=b({__name:"index",setup(c){const s=L(),t=I({fileList:[],result:""}),d=a=>{a&&(t.fileList=[a])},e=a=>{s.value.clearFiles();const l=a[0];l.uid=U(),s.value.handleStart(l)},h=()=>{if(!t.fileList.length){j({type:"info",message:"请上传图片"});return}let a=t.fileList[0].raw;new D(URL.createObjectURL(a)).blackWhite().then(_=>{t.result=_})},{fileList:n,result:r}=y(t);return(a,l)=>{const _=p("el-icon"),v=p("el-upload"),x=p("el-button");return m(),R("div",F,[i("div",null,[g(v,{ref_key:"uploadRef",ref:s,drag:"",action:"","auto-upload":!1,accept:".jpg,.png,.jpeg,.webp,.gif","on-exceed":e,"on-change":d,limit:1,"file-list":o(n),"onUpdate:fileList":l[0]||(l[0]=w=>k(n)?n.value=w:null)},{default:u(()=>[g(_,{class:"el-icon--upload"},{default:u(()=>[g(o(B))]),_:1}),M]),_:1},8,["file-list"])]),i("div",O,[o(n).length?(m(),C(x,{key:0,type:"info",onClick:h},{default:u(()=>[E("开始转换")]),_:1})):S("",!0)]),i("div",T,[W,i("div",q,[i("img",{src:o(r),alt:""},null,8,G)])])])}}});const A=V(P,[["__scopeId","data-v-7a07107c"]]);export{A as default};

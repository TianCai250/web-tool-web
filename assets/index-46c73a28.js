import{_ as b,r as L,a as I,t as R,b as g,o as m,d as k,e as i,f as u,w as p,u as o,i as y,x as S,h as U,l as j,E as B,m as C,j as E,p as H,n as N}from"./index-02cdd310.js";class V{constructor(s,e={}){this.imgSrc=s,this.target=e.target||null,this.width=e.width||null,this.height=e.height||null,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.image=new Image,this.image.src=this.imgSrc,this.target&&(this.target.innerHTML="",this.target.append(this.canvas))}blackWhite(){return new Promise(s=>{console.log(this.image),this.image.onload=()=>{this.canvas.width=this.width||this.image.width,this.canvas.height=this.height||this.image.height,this.context.drawImage(this.image,0,0,this.canvas.width,this.canvas.height);let e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),h=e.data.length;for(let t=0;t<h;t+=4){let d=e.data[t],l=e.data[t+1],r=e.data[t+2],a=d*.299+l*.587+r*.114>=128?255:0;e.data[t]=a,e.data[t+1]=a,e.data[t+2]=a}this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(e,0,0),this.canvas.toBlob(t=>{s(URL.createObjectURL(t))})}})}}const f=c=>(H("data-v-e4973ce6"),c=c(),N(),c),D={class:"image-gray"},F=f(()=>i("div",{class:"el-upload__text"},"拖拽或点击上传图片",-1)),M={class:"parse-btn"},O={class:"parse-result"},T=f(()=>i("div",{class:"label"},"转换结果",-1)),W={class:"result"},G=["src"],P={__name:"index",setup(c){const s=L(),e=I({fileList:[],result:""}),h=a=>{a&&(e.fileList=[a])},t=a=>{s.value.clearFiles();const n=a[0];n.uid=j(),s.value.handleStart(n)},d=()=>{if(!e.fileList.length){B({type:"info",message:"请上传图片"});return}let a=e.fileList[0].raw;new V(URL.createObjectURL(a)).blackWhite().then(_=>{e.result=_})},{fileList:l,result:r}=R(e);return(a,n)=>{const _=g("el-icon"),v=g("el-upload"),x=g("el-button");return m(),k("div",D,[i("div",null,[u(v,{ref_key:"uploadRef",ref:s,drag:"",action:"","auto-upload":!1,accept:".jpg,.png,.jpeg,.webp,.gif","on-exceed":t,"on-change":h,limit:1,"file-list":o(l),"onUpdate:fileList":n[0]||(n[0]=w=>y(l)?l.value=w:null)},{default:p(()=>[u(_,{class:"el-icon--upload"},{default:p(()=>[u(o(C))]),_:1}),F]),_:1},8,["file-list"])]),i("div",M,[o(l).length?(m(),S(x,{key:0,type:"info",onClick:d},{default:p(()=>[E("开始转换")]),_:1})):U("",!0)]),i("div",O,[T,i("div",W,[i("img",{src:o(r),alt:""},null,8,G)])])])}}},z=b(P,[["__scopeId","data-v-e4973ce6"]]);export{z as default};
